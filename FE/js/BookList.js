

const renderProducts = async (term) =>{
  console.log(term);
  let uri = 'http://localhost:3000/api/products?_sort=price&_order=desc';

  if(term) {
    uri += `&q=${term}`;
  }

  const res = await fetch(uri);
  const products = await res.json();
  console.log(products);
  var data = document.querySelector('.dataGrid');
  let template = '';
  products.forEach(product => {
    template += `

          <div class="card">
            <a href="/FE/BooksDetail.html?id=${product.id}">
              <div class="wishlist">
                <svg width="50" height="50" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <rect width="50" height="50" rx="6" fill="white"/>
                  <path d="M33.5206 17.2734C32.9938 16.7465 32.3683 16.3285 31.6799 16.0433C30.9914 15.7581 30.2536 15.6113 29.5084 15.6113C28.7633 15.6113 28.0254 15.7581 27.337 16.0433C26.6486 16.3285 26.0231 16.7465 25.4962 17.2734L25.0001 17.7695L24.504 17.2734C23.9772 16.7465 23.3517 16.3285 22.6633 16.0433C21.9748 15.7581 21.237 15.6113 20.4918 15.6113C19.7467 15.6113 19.0088 15.7581 18.3204 16.0433C17.632 16.3285 17.0065 16.7465 16.4796 17.2734C14.7785 18.9741 14.4816 21.5942 15.6866 24.2827C17.1554 27.561 24.0343 33.8608 24.3263 34.1274C24.5105 34.2955 24.7508 34.3886 25.0001 34.3886C25.2494 34.3886 25.4898 34.2955 25.6739 34.1274C25.9659 33.8608 32.8448 27.561 34.3136 24.2822C35.5187 21.5942 35.2218 18.9741 33.5206 17.2734ZM32.4894 23.4644C31.5197 25.6274 27.2404 29.915 25.0001 32.0244C22.7599 29.915 18.4816 25.6289 17.5109 23.4648C17.1027 22.5522 16.3214 20.2598 17.8937 18.6875C18.5828 17.9984 19.5173 17.6113 20.4918 17.6113C21.4663 17.6113 22.4009 17.9984 23.09 18.6875L24.2931 19.8906C24.386 19.9835 24.4962 20.0572 24.6175 20.1075C24.7388 20.1577 24.8688 20.1836 25.0002 20.1836C25.1315 20.1836 25.2615 20.1577 25.3828 20.1075C25.5041 20.0572 25.6144 19.9835 25.7072 19.8906L26.9103 18.6875C27.6104 18.0197 28.5409 17.6471 29.5084 17.6471C30.476 17.6471 31.4064 18.0197 32.1066 18.6875C33.6788 20.2598 32.8976 22.5522 32.4894 23.4644Z" fill="#131045"/>
                  </svg>
              </div>
              <div class="cover">
                <img src=${product.image}></img>
              </div>
              <h1>${product.name}</h1>
              <div class="subInfo">
                <h1>HORROR, DRAMA</h1>
              </div>
              <div class="stars">
                <span><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21.3904 11.6C21.6651 11.3192 21.8564 10.9676 21.9429 10.5845C22.0294 10.2013 22.0078 9.80161 21.8804 9.43002C21.7609 9.05733 21.5391 8.72569 21.2403 8.47288C20.9415 8.22006 20.5778 8.05622 20.1904 8.00002L15.9004 7.34002C15.8804 7.33422 15.862 7.32403 15.8464 7.31019C15.8308 7.29635 15.8185 7.27921 15.8104 7.26002L13.9304 3.26002C13.7656 2.88546 13.4953 2.56692 13.1527 2.34321C12.81 2.11949 12.4097 2.00025 12.0004 2.00002C11.5959 1.99835 11.1995 2.11353 10.8589 2.33173C10.5183 2.54993 10.248 2.86186 10.0804 3.23002L8.20042 7.23002C8.19016 7.24952 8.17599 7.26669 8.15878 7.28046C8.14157 7.29423 8.1217 7.30429 8.10043 7.31002L3.82042 8.00002C3.43252 8.05781 3.06825 8.22206 2.76813 8.47452C2.468 8.72698 2.24379 9.05774 2.12042 9.43002C1.99772 9.8029 1.97945 10.2023 2.06759 10.5848C2.15573 10.9673 2.34692 11.3184 2.62042 11.6L5.78043 14.85C5.78952 14.8705 5.79422 14.8926 5.79422 14.915C5.79422 14.9374 5.78952 14.9596 5.78043 14.98L5.04042 19.52C4.97163 19.9154 5.01648 20.3222 5.16975 20.6931C5.32302 21.064 5.57842 21.3838 5.90626 21.6152C6.2341 21.8467 6.6209 21.9804 7.02171 22.0007C7.42252 22.021 7.82086 21.9272 8.17042 21.73L11.9004 19.66C11.919 19.6504 11.9395 19.6453 11.9604 19.6453C11.9813 19.6453 12.0019 19.6504 12.0204 19.66L15.7504 21.73C16.1005 21.9229 16.4977 22.0134 16.8967 21.9913C17.2958 21.9691 17.6805 21.835 18.007 21.6045C18.3335 21.374 18.5886 21.0563 18.743 20.6877C18.8974 20.319 18.9451 19.9144 18.8804 19.52L18.1904 15C18.1799 14.9818 18.1743 14.9611 18.1743 14.94C18.1743 14.919 18.1799 14.8983 18.1904 14.88L21.3904 11.6Z" fill="#FF754C"/>
                  </svg>
                  </span>
                <span><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21.3904 11.6C21.6651 11.3192 21.8564 10.9676 21.9429 10.5845C22.0294 10.2013 22.0078 9.80161 21.8804 9.43002C21.7609 9.05733 21.5391 8.72569 21.2403 8.47288C20.9415 8.22006 20.5778 8.05622 20.1904 8.00002L15.9004 7.34002C15.8804 7.33422 15.862 7.32403 15.8464 7.31019C15.8308 7.29635 15.8185 7.27921 15.8104 7.26002L13.9304 3.26002C13.7656 2.88546 13.4953 2.56692 13.1527 2.34321C12.81 2.11949 12.4097 2.00025 12.0004 2.00002C11.5959 1.99835 11.1995 2.11353 10.8589 2.33173C10.5183 2.54993 10.248 2.86186 10.0804 3.23002L8.20042 7.23002C8.19016 7.24952 8.17599 7.26669 8.15878 7.28046C8.14157 7.29423 8.1217 7.30429 8.10043 7.31002L3.82042 8.00002C3.43252 8.05781 3.06825 8.22206 2.76813 8.47452C2.468 8.72698 2.24379 9.05774 2.12042 9.43002C1.99772 9.8029 1.97945 10.2023 2.06759 10.5848C2.15573 10.9673 2.34692 11.3184 2.62042 11.6L5.78043 14.85C5.78952 14.8705 5.79422 14.8926 5.79422 14.915C5.79422 14.9374 5.78952 14.9596 5.78043 14.98L5.04042 19.52C4.97163 19.9154 5.01648 20.3222 5.16975 20.6931C5.32302 21.064 5.57842 21.3838 5.90626 21.6152C6.2341 21.8467 6.6209 21.9804 7.02171 22.0007C7.42252 22.021 7.82086 21.9272 8.17042 21.73L11.9004 19.66C11.919 19.6504 11.9395 19.6453 11.9604 19.6453C11.9813 19.6453 12.0019 19.6504 12.0204 19.66L15.7504 21.73C16.1005 21.9229 16.4977 22.0134 16.8967 21.9913C17.2958 21.9691 17.6805 21.835 18.007 21.6045C18.3335 21.374 18.5886 21.0563 18.743 20.6877C18.8974 20.319 18.9451 19.9144 18.8804 19.52L18.1904 15C18.1799 14.9818 18.1743 14.9611 18.1743 14.94C18.1743 14.919 18.1799 14.8983 18.1904 14.88L21.3904 11.6Z" fill="#FF754C"/>
                  </svg>
                  </span>
                <span><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21.3904 11.6C21.6651 11.3192 21.8564 10.9676 21.9429 10.5845C22.0294 10.2013 22.0078 9.80161 21.8804 9.43002C21.7609 9.05733 21.5391 8.72569 21.2403 8.47288C20.9415 8.22006 20.5778 8.05622 20.1904 8.00002L15.9004 7.34002C15.8804 7.33422 15.862 7.32403 15.8464 7.31019C15.8308 7.29635 15.8185 7.27921 15.8104 7.26002L13.9304 3.26002C13.7656 2.88546 13.4953 2.56692 13.1527 2.34321C12.81 2.11949 12.4097 2.00025 12.0004 2.00002C11.5959 1.99835 11.1995 2.11353 10.8589 2.33173C10.5183 2.54993 10.248 2.86186 10.0804 3.23002L8.20042 7.23002C8.19016 7.24952 8.17599 7.26669 8.15878 7.28046C8.14157 7.29423 8.1217 7.30429 8.10043 7.31002L3.82042 8.00002C3.43252 8.05781 3.06825 8.22206 2.76813 8.47452C2.468 8.72698 2.24379 9.05774 2.12042 9.43002C1.99772 9.8029 1.97945 10.2023 2.06759 10.5848C2.15573 10.9673 2.34692 11.3184 2.62042 11.6L5.78043 14.85C5.78952 14.8705 5.79422 14.8926 5.79422 14.915C5.79422 14.9374 5.78952 14.9596 5.78043 14.98L5.04042 19.52C4.97163 19.9154 5.01648 20.3222 5.16975 20.6931C5.32302 21.064 5.57842 21.3838 5.90626 21.6152C6.2341 21.8467 6.6209 21.9804 7.02171 22.0007C7.42252 22.021 7.82086 21.9272 8.17042 21.73L11.9004 19.66C11.919 19.6504 11.9395 19.6453 11.9604 19.6453C11.9813 19.6453 12.0019 19.6504 12.0204 19.66L15.7504 21.73C16.1005 21.9229 16.4977 22.0134 16.8967 21.9913C17.2958 21.9691 17.6805 21.835 18.007 21.6045C18.3335 21.374 18.5886 21.0563 18.743 20.6877C18.8974 20.319 18.9451 19.9144 18.8804 19.52L18.1904 15C18.1799 14.9818 18.1743 14.9611 18.1743 14.94C18.1743 14.919 18.1799 14.8983 18.1904 14.88L21.3904 11.6Z" fill="#FF754C"/>
                  </svg>
                  </span>
                <span><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M21.3904 11.6C21.6651 11.3192 21.8564 10.9676 21.9429 10.5845C22.0294 10.2013 22.0078 9.80161 21.8804 9.43002C21.7609 9.05733 21.5391 8.72569 21.2403 8.47288C20.9415 8.22006 20.5778 8.05622 20.1904 8.00002L15.9004 7.34002C15.8804 7.33422 15.862 7.32403 15.8464 7.31019C15.8308 7.29635 15.8185 7.27921 15.8104 7.26002L13.9304 3.26002C13.7656 2.88546 13.4953 2.56692 13.1527 2.34321C12.81 2.11949 12.4097 2.00025 12.0004 2.00002C11.5959 1.99835 11.1995 2.11353 10.8589 2.33173C10.5183 2.54993 10.248 2.86186 10.0804 3.23002L8.20042 7.23002C8.19016 7.24952 8.17599 7.26669 8.15878 7.28046C8.14157 7.29423 8.1217 7.30429 8.10043 7.31002L3.82042 8.00002C3.43252 8.05781 3.06825 8.22206 2.76813 8.47452C2.468 8.72698 2.24379 9.05774 2.12042 9.43002C1.99772 9.8029 1.97945 10.2023 2.06759 10.5848C2.15573 10.9673 2.34692 11.3184 2.62042 11.6L5.78043 14.85C5.78952 14.8705 5.79422 14.8926 5.79422 14.915C5.79422 14.9374 5.78952 14.9596 5.78043 14.98L5.04042 19.52C4.97163 19.9154 5.01648 20.3222 5.16975 20.6931C5.32302 21.064 5.57842 21.3838 5.90626 21.6152C6.2341 21.8467 6.6209 21.9804 7.02171 22.0007C7.42252 22.021 7.82086 21.9272 8.17042 21.73L11.9004 19.66C11.919 19.6504 11.9395 19.6453 11.9604 19.6453C11.9813 19.6453 12.0019 19.6504 12.0204 19.66L15.7504 21.73C16.1005 21.9229 16.4977 22.0134 16.8967 21.9913C17.2958 21.9691 17.6805 21.835 18.007 21.6045C18.3335 21.374 18.5886 21.0563 18.743 20.6877C18.8974 20.319 18.9451 19.9144 18.8804 19.52L18.1904 15C18.1799 14.9818 18.1743 14.9611 18.1743 14.94C18.1743 14.919 18.1799 14.8983 18.1904 14.88L21.3904 11.6Z" fill="#FF754C"/>
                  </svg>
                  </span>
                <span><svg width="20" height="21" viewBox="0 0 20 21" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <path d="M19.3904 9.60002C19.6651 9.31922 19.8564 8.96762 19.9429 8.58445C20.0294 8.20128 20.0078 7.80161 19.8804 7.43002C19.7609 7.05733 19.5391 6.72569 19.2403 6.47288C18.9415 6.22006 18.5778 6.05622 18.1904 6.00002L13.9004 5.34002C13.8804 5.33422 13.862 5.32403 13.8464 5.31019C13.8308 5.29635 13.8185 5.27921 13.8104 5.26002L11.9304 1.26002C11.7656 0.885457 11.4953 0.56692 11.1527 0.343206C10.81 0.119491 10.4097 0.000254073 10.0004 1.79599e-05C9.59592 -0.00165464 9.19955 0.113532 8.85894 0.331732C8.51834 0.549932 8.248 0.861859 8.08042 1.23002L6.20042 5.23002C6.19016 5.24952 6.17599 5.26669 6.15878 5.28046C6.14157 5.29423 6.1217 5.30429 6.10043 5.31002L1.82042 6.00002C1.43252 6.05781 1.06825 6.22206 0.768125 6.47452C0.468001 6.72698 0.243789 7.05774 0.120425 7.43002C-0.00227753 7.8029 -0.0205489 8.20226 0.0675919 8.58479C0.155733 8.96733 0.346921 9.31843 0.620425 9.60002L3.78043 12.85C3.78952 12.8705 3.79422 12.8926 3.79422 12.915C3.79422 12.9374 3.78952 12.9596 3.78043 12.98L3.04042 17.52C2.97163 17.9154 3.01648 18.3222 3.16975 18.6931C3.32302 19.064 3.57842 19.3838 3.90626 19.6152C4.2341 19.8467 4.6209 19.9804 5.02171 20.0007C5.42252 20.021 5.82086 19.9272 6.17042 19.73L9.90042 17.66C9.91895 17.6504 9.93954 17.6453 9.96042 17.6453C9.98131 17.6453 10.0019 17.6504 10.0204 17.66L13.7504 19.73C14.1005 19.9229 14.4977 20.0134 14.8967 19.9913C15.2958 19.9691 15.6805 19.835 16.007 19.6045C16.3335 19.374 16.5886 19.0563 16.743 18.6877C16.8974 18.319 16.9451 17.9144 16.8804 17.52L16.1904 13C16.1799 12.9818 16.1743 12.9611 16.1743 12.94C16.1743 12.919 16.1799 12.8983 16.1904 12.88L19.3904 9.60002Z" fill="#E1E1E1"/>
                  </svg>
                  </span>
              </div>
            </a>
          </div>


      `
    });
    data.innerHTML = template;
  }
  var searchForm = document.querySelector('.search');
  searchForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    renderProducts(searchForm.term.value.trim());
  })

  window.addEventListener('DOMContentLoaded', () => renderProducts() );
